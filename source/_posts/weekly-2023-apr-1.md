---
title: 一周杂记 in Week 1 Apr 2023
categories: CODE-LIFE
date: 2023-04-10 00:56:14
tags: [杂记]
---
本周（04/03 ~ 04/09）是四月份正式的第一周。

## Life

\#1

周三清明节放了一天假，这样这周就变成了工作两天，休息一天，然后再工作两天。

这样一套下来有了两个感悟：

1. 一周四天工作制真的会爽很多，毕竟比起双休多了50%。多出来的时间陪老婆出去转转，吃吃喝喝看看电影都是非常不错的
2. 一周单休的工作实在太可怕了，比起双休是直接少了50%的休息时间

不过就天朝目前这样子，一周四天工作制是绝对不可能的。经济下行，本来就消费不足，全靠外资投资拉动。结果之前你有把人家打跑了，加上封控的破坏，能稳住基本盘就不错了。

\#2

这周看了两部电影：

- 宇宙探索编辑部 7.5/10 实话说现在的我不是很喜欢这个电影，但是十年前的我估计会非常喜欢。另外就是手持摄像实在是太晃了....
- house of gucci 5/10 难以想象这是老雷拍的电影，全程流水账，剪辑非常细碎，连一个完整的故事都算不上

\#3

周六晚上要去迪卡侬买衣服，所以和媳妇儿跑到西溪天街吃个晚饭。但是人太多了所以最后选了一家韩式烤肉店。

但是这家店真的是...味道没有一丝让人觉得惊艳的地方，而且性价比实际上也不是很高，两人花了188左右。

周日的时候老婆惊喜发现西溪银泰的九田家居然又开了，于是我们再打了半小时乒乓球又健身房练了半小时后就去了西溪银泰。

整体体验又回到了当初的水准，比昨天那家高明不知道哪里去了。不过银泰的店确实是真的贵，没有走套餐，自己两个人选点的，最后吃完用了两张92代100的券也花了290...

不过味道是真的不错啊 🤣

## Work

\#1

本周学习进度如下

《Apache Kafka 实战》看完了

- 8. 监控 Kafka 集群
- 9. 调优 Kafka 集群

这两部分其实可以作为一些手册备查，毕竟和运维属性关联性更强。

另外这本书只剩下最后一章讲 kafka stream 的，估计下周就能看完。进度还是挺快的

《重新理解创业》看完了

- 8. 如何打造一个团队
- 9. 重新理解企业成长

_DDIA_ 还在继续看

- 3. Storage and Retrieval

看完了 LSM 和 B-Tree 作为 DB 存储引擎的内容。

不得不说 DDIA 在循循善诱上做的是真的好

_CppCon 2020_

- Modern C++ Safety and Security At 20 - Matthew Butler
  这个 talk 其实也是讲的 C++ 20 的特性，不过是针对 embedded system。干货也有一些，比如好像发现了 ranges 的 `|` 开销不算低？

\#2

这周给公司的项目写了一个基于 docker-compose 快速服务部署的配置，可以讲构建之后的二进制和配置打包成 docker image 然后运行容器配置好各项属性，例如端口和 mount volume 等。

作用是为了可以让我们针对运行的服务写 e2e tests，因为某些功能和逻辑用单纯的单元测试不太容易覆盖，毕竟我们一次请求会经历上游的 api service 和下游的 service。

除了 docker-compose 之外还研究了一把利用 testify/mock 和 mockery 怎么实现 mock 来使得某些业务逻辑的单元测试可测性变得可能。

比如我们的 api service 依赖一个 kafka 将消息 pub，但是在此之前有一些相对复杂的逻辑，而要针对这些逻辑做 ut 就最好不要把 kafka 的逻辑也给引入。这个时候用 mock 把 kafka 换掉就是一个比较合理的选择。

不过这部分还没完全研究完，因为 golang 的导出特性，导致一开始的效果和我预想的不太一样。

不出意外的话下周应该要继续做这个。

\#3

这周把 glog 的单条日志的 flow 都研究明白了，顺带还过了一些小的疑问点。

但是因为之前定的点比较多，所以后续会逐步的研究分析。

第一部分的分析已经抽时间写成了 blog post，见 https://kingsamchen.github.io/2023/04/09/src-study-glog-1/

---

好了这周就这样，下周见
