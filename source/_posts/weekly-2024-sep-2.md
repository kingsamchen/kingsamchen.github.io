---
title: ä¸€å‘¨æ‚è®° in Week 2 Sep 2024
categories: CODE-LIFE
date: 2024-09-16 14:27:54
tags: [æ‚è®°]
---
æœ¬å‘¨ï¼ˆ09/09 ~ 09/15ï¼‰æ˜¯9æœˆä»½ç¬¬äºŒå‘¨ï¼Œ09/15 æ˜¯ä¸­ç§‹å‡æœŸç¬¬ä¸€å¤©

## Life

\#1

è¿™å‘¨å› ä¸ºä¸­ç§‹æ‰€ä»¥åˆå¾ˆè›‹ç–¼çš„æœ‰è°ƒä¼‘ï¼Œå‘¨å…­ä¸Šç­ï¼Œæ—¥ä¸€äºŒæ”¾å‡ï¼Œç¡¬ç”Ÿç”Ÿåœ°è¦æä¸€ä¸ªå‡æœŸï¼ŒçœŸè›‹ç–¼ã€‚

å‘¨äº”æ¸…æ—©å¼€è½¦é€åª³å¦‡å„¿å»å¯Œé˜³ï¼Œä¸­åˆåƒäº†é¥­ä¹‹åå°±å›å®¶äº†ï¼Œä¸‹åˆç»§ç»­å»åŠå…¬å®¤ä¸Šç­äº†

å‘¨å…­æƒ³äº†ä¸€ä¸‹è¿˜æ˜¯å»åŠå…¬å®¤å¥½äº†ï¼Œæœä¸å…¶ç„¶ä¸­åˆæœ‰åŒäº‹æè®®å»å·é‡åƒä¸€é¡¿ï¼Œç®—æ˜¯èµ¶ä¸Šäº† ğŸ¤£

\#2

å‘¨ä¸‰å…¬å¸ç”µå½±ä¿±ä¹éƒ¨æ”¾æ˜ ã€ŠXã€‹ï¼Œåª³å¦‡å„¿ä¹Ÿæœ‰ç‚¹æ„Ÿå…´è¶£ï¼Œå°±ä½œä¸ºè®¿å®¢ä¸€èµ·çœ‹äº†ç”µå½±ã€‚

ä¸‹å›è¦æ˜¯æœ‰ä¸é”™çš„ç”µå½±åˆæ°å¥½ç¢°åˆ°åª³å¦‡å„¿ä¼‘å‡çš„è¯å¯ä»¥å¤šæ‹‰ä»–æ¥å‚åŠ  ğŸ˜…

æœ¬æ¥å‘¨å››ä¸‹åˆé€åª³å¦‡å„¿å»å¯Œé˜³ä½†æ˜¯å› ä¸ºå¤ªçƒ­äº†ï¼Œé‚£è¾¹çš„æˆ¿é—´ç©ºè°ƒåˆåäº†æ‰€ä»¥å°±æ”¹åˆ°äº†å‘¨äº”æ—©ä¸Šï¼›äºæ˜¯å‘¨å››æ™šä¸Šå»è¸¢çƒäº†ã€‚

ä½†æ˜¯å› ä¸ºè¿™æ¬¡æŠ¥åçš„å¤ªå°‘ï¼Œä»–ä»¬æ‰¾äº†4-5ä¸ªå¤–æ´ï¼Œæˆ‘ä»¬å¤§å¤šæ•°äººå®Œå…¨ä¸è®¤è¯†çš„é‚£ç§ã€‚

è®²é“ç†è¿™æ¬¡ä½“éªŒæŒºå·®çš„ï¼Œå› ä¸ºæœ‰å°†è¿‘ä¸€åŠçš„äººä¸æ˜¯è‡ªå·±åŒäº‹ï¼Œæˆ‘å°±æ„Ÿè§‰ç‰¹åˆ«å®¹æ˜“å—ä¼¤ï¼›è€Œä¸”å› ä¸ºä»–ä»¬å¤–æ´è‡ªå·±æƒ³è¦ä¸€é˜Ÿï¼Œæˆ‘å’Œchaoå°±å˜æˆå¤–æ´é˜Ÿé‡Œçš„è‡ªå·±äººã€‚

ç„¶åå¯¹é¢è‡ªå·±åŒäº‹å¯¹æŠ—çš„æ—¶å€™è¿˜çœŸå°±æŒºç‹ çš„ï¼Œchaoçš„å°è…¿å’Œè†ç›–éƒ½è¢«æ’é’äº†ï¼Œè¿˜å¥½æˆ‘å½“æ—¶æœºæ™ºï¼Œè§‰å¾—æœ‰ç‚¹å±é™©ï¼Œç›´æ¥å˜æˆäº†åˆ’æ°´æ¨¡å¼ï¼Œè±¡å¾æ€§çš„è¸¢è¸¢ã€‚

æ„Ÿè§‰æœ€è¿‘å¯ä»¥å…ˆæ­‡å‡ åœºäº†ï¼Œç¡®å®æœ‰ç‚¹ä¸å¤ªç¨³å¦¥

\#3

æœ¬å‘¨è§‚å½±

- **X** 4/5 æ¯”é¢„æƒ³çš„æœ‰æ„æ€çš„å¤šï¼Œè€Œä¸”è¿˜æºæ‚äº†ä¸€äº›å¯¼æ¼”/ç¼–å‰§è‡ªå·±çš„ç§è´§ï¼Œå‰ªè¾‘æ‰‹æ³•æœ‰ç‚¹å¯ä»¥ã€‚ è¿™ç‰‡å‘Šè¯«ä¸–äººé•¿æ—¶é—´æ— æ€§ç”Ÿæ´»äººä¼šå˜ç–¯é­” ğŸ¤£
- **ä»21ä¸–çºªå®‰å…¨æ’¤ç¦»** 3/5 è¿˜å¥½æ²¡å»ç”µå½±é™¢çœ‹....äººç‰©å¤ªå¹³äº†ï¼Œæ•…äº‹ä¹Ÿè€å¥—ï¼Œå¤šå°‘å¹´äº†è¿™é£æ ¼çœ‹å¤šäº†è¿˜èƒƒç–¼

## Work

\#1

**CppCon 2022 | Contemporary C++ in Action - Daniela Engert** https://www.youtube.com/watch?v=yUIFdL3D0Vk&list=PLHTh1InhhwT6c2JNtUiJkaH8YRqzhU7Ag&index=31

- ä»¥ä¸€ä¸ªå¸¦ç½‘ç»œå’Œè§†é¢‘ç¼–è§£ç çš„ demo é¡¹ç›®ä¸ºä¾‹å­æ¥è®²è§£ C++ 20/23 çš„ç‰¹æ€§èƒ½å¸¦æ¥çš„å¸®åŠ©
- å±äºå¹²è´§æ¯”è¾ƒå¤šçš„ä¸€ä¸ªåˆ†äº«ï¼Œä¸è¿‡éœ€è¦è‡ªå·±å»çœ‹çœ‹ sample code

**CppCon 2022 | Killing C++ Serialization Overhead & Complexity - Eyal Zedaka** https://www.youtube.com/watch?v=G7-GQhCw8eE&list=PLHTh1InhhwT6c2JNtUiJkaH8YRqzhU7Ag&index=34

- ä»‹ç»çš„æ˜¯ä½œè€…è‡ªå·±å†™çš„ä¸€ä¸ª C++20 çš„åº“ zpp å·ç§° zero-overhead çš„ binary serialization
- æ ¸å¿ƒç‚¹æ˜¯å¤§é‡çš„ compile-time tricksï¼ˆä¾èµ–æµ·é‡ conceptsï¼‰è¿˜æœ‰ force inline æ¥æå‡æ€§èƒ½ï¼›åˆ©ç”¨ç±»ä¼¼ boost/pfr çš„æ–¹å¼æ¥ visit struct member æ¥æ¨¡æ‹Ÿ compile-time reflection

**CppCon 2022 | Deciphering C++ Coroutines - A Diagrammatic Coroutine Cheat Sheet - Andreas Weis** https://www.youtube.com/watch?v=J7fYddslH0Q&list=PLHTh1InhhwT6c2JNtUiJkaH8YRqzhU7Ag&index=35

- æ„Ÿè§‰æ˜¯çœ‹è¿‡æ¥è®²çš„æœ€å¥½çš„ä¸€ä¸ª coroutine basics çš„ talkï¼Œä»æœ€å¸¸ç”¨çš„ syntax å¼€å§‹æŠŠ promise_type return_type awaitable è¿™äº›ä¸œè¥¿ç»™è¡¥å…¨äº†

**CppCon 2022 | Back to Basics: The C++ Core Guidelines - Rainer Grimm** https://www.youtube.com/watch?v=UONLB7wBVSc&list=PLHTh1InhhwT6c2JNtUiJkaH8YRqzhU7Ag&index=33

- ä» core guidelines é‡ŒæŒ‘å‡ºä¸€äº›æ¥è®²è®²
- ä½†æ˜¯æ„Ÿè§‰è¿™æ¬¡è¿™ä¸ªä¸€èˆ¬

**C++ Weekly - Ep 373 - Design Patterns in "Modern" C++ (2023)** https://www.youtube.com/watch?v=A_MsXney3EU

- å…¶å®å°±è®²äº† observer pattern åœ¨ modern c++ ä¸­å¯ä»¥ç”¨ signal/slot è¿™ç§æ‰‹æ³•æ¥æ›¿ä»£
- å®ç°ä¸Šè¦æ³¨æ„è¢«å¼•ç”¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ

**C++ Weekly - Ep 279 - Quick Perf Tip: Use The Right Iterator Comparison** https://www.youtube.com/watch?v=oelQ4uAw2WQ

- ç”¨ `!= end` æ¥åˆ¤æ–­è¿­ä»£å™¨æ€§èƒ½èƒ½æå‡ 10%
- ç„¶åè¯„è®ºé‡Œæåˆ°äº†è¿™å¯èƒ½ä¸æ˜¯ JB å’Œ JE æŒ‡ä»¤çš„å·®è·ï¼Œä»–ä»¬ä¸¤ä¸ªåœ°ä¸‹éƒ½æ˜¯ä¸€æ ·çš„ JCC æŒ‡ä»¤ï¼Œæ€§èƒ½å·®å¼‚åº”è¯¥æ¥æºäº CPU speculative execution ä¸€ç±»çš„å¾®è§‚ä¼˜åŒ–

**Did you know that C++20 made typename more optional?** https://github.com/tip-of-the-week/cpp/blob/master/tips/233.md

- C++ 20 å¼€å§‹åœ¨ä¸€äº›æ˜ç¡®éœ€è¦ä½¿ç”¨ type çš„ä¸Šä¸‹æ–‡å¯ä»¥çœç•¥ dependent name å‰ç½®çš„ typename

**The Worst Best Practices - Jason Turner - [CppNow 2021]** https://www.youtube.com/watch?v=KeI03tv9EKE

- éæŠ€æœ¯æ€§ talkï¼Œä¸»è¦æ˜¯ä½œè€…è¿™ä¹ˆå¤šå¹´æ¥çš„ä¸€äº›ä¸ªäººæ„Ÿæ‚Ÿï¼Œæ¯”å¦‚åœ¨ç½‘ä¸Šåˆ†äº«æ–‡ç« ä¼šé‡åˆ°ä¸€ä¸ªå¾ˆ mean çš„äººå’Œ commentsï¼›å¦‚ä½•åœ¨ leanpub ä¸Šè‡ªå·±å‡ºç‰ˆä¸€äº›ä¹¦ç±

**Creating a task completion source for a C++ coroutine: Producing nothing** https://devblogs.microsoft.com/oldnewthing/20210325-00/?p=105002

- ç³»åˆ—ç¬¬33ç¯‡
- åˆ©ç”¨ç±»åç‰¹åŒ–ç»™åŠ ä¸Šç±»ä¼¼ `Tastk<void>` çš„æ”¯æŒ

**Creating a task completion source for a C++ coroutine: Failing to produce a result** https://devblogs.microsoft.com/oldnewthing/20210326-00/?p=105009

- ç³»åˆ—ç¬¬34ç¯‡
- æ‰‹æ“äº†ä¸€ä¸ª union/variant æŠŠ exception_ptr å¡è¿›å»äº†ï¼Œç„¶åå‰©ä¸‹çš„å°±æ˜¯è¡¥è¶³è¦æ”¯æŒ exception éƒ¨åˆ†çš„é€»è¾‘

**C++ coroutines: The mental model for coroutine promises** https://devblogs.microsoft.com/oldnewthing/20210329-00/?p=105015

- ç³»åˆ—ç¬¬35ç¯‡
- coroutine çš„ promise åŸºç¡€è®²è§£

**C++ coroutines: Basic implementation of a promise type** https://devblogs.microsoft.com/oldnewthing/20210330-00/?p=105019

- ç³»åˆ—ç¬¬36ç¯‡
- coroutine_traits è®²è§£

\#2

è¿™å‘¨æŠŠ nlohmann-json serde ä¸€å¼€å§‹è§„åˆ’çš„å¤§éƒ¨åˆ†çš„å®ç°éƒ½å†™å®Œäº†ï¼Œåé¢ç³Šä¸€ä¸‹ README å°±å¯ä»¥ make public äº† ğŸ¤£

è¿‡ç¨‹ä¸­åœ¨ ubuntu 2404 ä¸Šç”¨ gcc-13 ç¼–è¯‘çš„æ—¶å€™å‘ç°ç¼–è¯‘æœ‰å‘Šè­¦å¤±è´¥äº†ï¼Œä»”ç»†ç ”ç©¶äº†ä¸€ä¸‹å‘ç°æ˜¯ gcc-13 å¼•å…¥çš„æ–°å‘Šè­¦ `-Wchange-meaning`ï¼Œè¯¦ç»†ä»‹ç»å¯ä»¥è§[è¿™é‡Œ](https://developers.redhat.com/articles/2023/06/21/new-c-features-gcc-13#new_and_improved_warnings)

å…·ä½“æ¥è¯´å°±æ˜¯å¦‚ä¸‹ä»£ç 

```cpp
struct foobar {};

struct test {
    foobar foobar;
};
```

L84 ä¸­ `foobar` ä»ç±»å‹å˜æˆäº†å˜é‡ï¼Œå°±ä¼šè§¦å‘å‘Šè­¦

```
<source>:4:12: error: declaration of 'foobar test::foobar' changes meaning of 'foobar' [-Wchanges-meaning]
    4 |     foobar foobar;
      |            ^~~~~~
<source>:4:5: note: used here to mean 'struct foobar'
    4 |     foobar foobar;
      |     ^~~~~~
<source>:1:8: note: declared here
    1 | struct foobar {};
      |        ^~~~~~
Compiler returned: 1
```

ç»†å¿ƒçš„äººå‘ç°äº†è¿™å¯¹ä½¿ç”¨æ ‡å‡†åº“çš„ naming style çš„äººéå¸¸ä¸åˆ©å•Š...

è§£å†³æ–¹æ¡ˆå°±æ˜¯ç±»å‹åå’Œå˜é‡åä¸è¦é‡åˆ ğŸ˜…

\#3

è¿™å‘¨ç»™å…¬å¸æŸä¸ªæ¨¡å—æ”¹ä»£ç çš„æ—¶å€™ç”¨äº†åŸºäº CRTP å®ç°çš„ chain-of-responsiblity patternï¼Œç”¨ `std::function` åšç±»å‹æ“¦é™¤ï¼Œè¿™æ ·æ•´ä½“ä¸Šå°±é¿å…äº†è™šå‡½æ•°å’Œè‡ªå·±æ‰‹åŠ¨çš„åŠ¨æ€å†…å­˜åˆ†é…ã€‚

ç®€åŒ–ä¸€ä¸‹ï¼Œç¤ºä¾‹ä»£ç å¤§æ¦‚é•¿è¿™æ ·

```cpp
template<typename T>
struct ExternalEventHanlderBase {
    template<typename H, typename... Hs>
    void setNextHandler(H h, Hs... hs) {
        if constexpr (sizeof...(hs) > 0) {
            h.setNextHandler(hs...);
        }

        next_ = h;
    }

    bool operator()(int n) {
        auto ret = static_cast<T*>(this)->impl(n);
        if (ret) {
            return true;
        }

        return next_ ? next_(n) : false;
    }

    std::function<bool(int)> next_;
};

struct ICSEventHandler : ExternalEventHanlderBase<ICSEventHandler> {
    bool impl(int n) {
        std::cout << "ICS Event Handler\n";
        return n < 10;
    }
};

struct TNEFEventHandler : ExternalEventHanlderBase<TNEFEventHandler> {
    bool impl(int n) {
        std::cout << "TNEF Event Handler\n";
        return n < 50;
    }
};

struct HandlerHead : ExternalEventHanlderBase<HandlerHead> {
    bool impl(int) {
        return false;
    }
};

int main() {
    HandlerHead handlers;
    handlers.setNextHandler(ICSEventHandler{}, TNEFEventHandler{});
    handlers(25);
    return 0;
}
```

https://gcc.godbolt.org/z/TYGsGs85z

---

å¥½äº†è¿™å‘¨å°±è¿™æ ·ï¼Œä¸‹å‘¨è§
