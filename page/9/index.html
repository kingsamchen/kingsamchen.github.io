<!DOCTYPE html>
<html lang="default">
  <head><meta name="generator" content="Hexo 3.9.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="Gone with the ruins">













  <link rel="alternate" href="/atom.xml" title="KC的废墟堆">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.6.0">



<link rel="canonical" href="http://kingsamchen.github.io/page/9/">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.6.0">






  



  









    <title> KC的废墟堆 </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">KC的废墟堆</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
      <a href="/friends/">
        <li class="mobile-menu-item">
          
          
            Friends
          
        </li>
      </a>
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            关于
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">KC的废墟堆</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/friends/">
            
            
              Friends
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              关于
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  <section id="posts" class="posts">
    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2018/07/06/running-linux-gui-applications-on-windows/">在 Windows 上运行 Linux GUI 程序</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-07-06
        </span>
        
          <div class="post-category">
            
              <a href="/categories/CODE-LIFE/">CODE-LIFE</a>
            
          </div>
        
        
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <p>自从 Windows 10 提供 WSL 之后，在 Windows 上运行 Linux CLI 程序并不是一个复杂的事情；然而俗话说饱暖思淫欲，既然可以做到在 Windows 上跑 Linux CLI 了，下一步自然想的是在 Windows 上跑 Linux GUI 程序。</p>
<p>之所以要跑 GUI 是因为，无论是 vscode 还是 CLion，写 C++ 的体验都比在 terminal 里开一个 vim 要好太多了，无论你是花了多少时间配置了 <code>.vimrc</code>，在 CLion 面前都是战五渣。更何况我买了 Jetbrains 的 All product license，不用用难道留着过年吗。</p>
<p>这里先解答两个常见疑问：</p>
<p>Q：为什么不直接在虚拟机里使用？<br>A：因为 Linux 对 4K 屏原生支持太糟糕。哪怕 Mint 提供了 double scaling，解决了一些外观上的问题，我在 4K 的环境下一开 vscode 程序就崩溃，而且运行操作明显掉帧。<br>另外一个问题是，单纯的虚拟机操作和外界宿主太隔离，等于我得配置两套完全一样的环境（比如浏览器，常见的应用，甚至 SS 等），而且和宿主的交互非常不够便利。</p>
<p>Q：为什么不买 macbook？<br>A：？？你是认真的么？OS X 那么垃圾的系统。再说我要写 C++ server-end 的代码，要是可以用 OS X 我为什么不直接在 Windows 上跑?</p>
<p>另外有一个剧透：我尝试过运行 WSL 里的 Linux GUI 程序，例如 CLion，但是目前 WSL 的文件系统性能过于糟糕，CLion 一个劲的冒错误提示，所以，下面的环境假定是虚拟机里的 Linux 或者一台单独的 Linux 设备。<br>
          <div class="read-more">
            <a href="/2018/07/06/running-linux-gui-applications-on-windows/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </p></div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2018/07/01/monthly-read-posts-in-jun-2018/">Monthly Read Posts in Jun 2018</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-07-01
        </span>
        
          <div class="post-category">
            
              <a href="/categories/PROGRAMMING/">PROGRAMMING</a>
            
          </div>
        
        
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <h2 id="Programming-Language"><a href="#Programming-Language" class="headerlink" title="Programming Language"></a>Programming Language</h2><p><a href="https://www.youtube.com/watch?v=iLiDezv_Frk" target="_blank" rel="noopener">CppCon 2015: Richard Powell “Intro to the C++ Object Model”
</a></p>
<p>基本覆盖了 POD，无需函数类，单继承的情况，扫盲效果俱佳。</p>
<p>至于为什么没有包含 multiple inheritance / virtual inheritance，作者说自己不是很 condifent with that。</p>
<p>讲道理，MI / VI 在一般的设计里都会尽量避免，而且各种乱七八糟的 case 很多，这里不涉及反而是个正确的做法。</p>
<hr>
<p><a href="https://akrzemi1.wordpress.com/2011/04/06/assertions/" target="_blank" rel="noopener">Assertions</a></p>
<p>首先，我很赞同文中作者对于 assertion 是 <em>guarantees given by the author of a piece of code to himself/herself</em> 但是接下来的大部观点都不赞同。</p>
<p>比如作者认为不应该 assert on precodintions &amp; postconditions，因为 assertion 是 for implementation details，这个思路其实不对。</p>
<p>关于 assertion，目前看过最好的阐述还是 <a href="https://book.douban.com/subject/3406939/" target="_blank" rel="noopener">Writing Solid Code</a>，推荐去阅读这个。</p>
<hr>
<p><a href="https://akrzemi1.wordpress.com/2011/05/06/compile-time-computations/" target="_blank" rel="noopener">Compile-time computations</a></p>
<p>这篇 post 展示了 constexpr functions 错误报告的常见手段：抛异常。</p>
<p>这个在之前的某个 cppcon talk 里有专门的介绍。</p>
<p>另外，文中更进一步，抽出专门的 constexpr validation functions，并通过 comma operator 串联。</p>
<p>C++ 14 支持多句之后，连 comma operatos 都可以免掉了。</p>
<hr>
          <div class="read-more">
            <a href="/2018/07/01/monthly-read-posts-in-jun-2018/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2018/06/19/modern-cmake/">Modern CMake</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-06-19
        </span>
        
          <div class="post-category">
            
              <a href="/categories/PROGRAMMING/">PROGRAMMING</a>
            
          </div>
        
        
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        

        
          <p>但凡有点历史的东西，在演进到一个新的阶段时，总会总结一套新的 practices 然后冠之以 modern，例如 modern C++，还有今天的主题 —— modern CMake。</p>
<p>上周花了一点时间稍微研究了一下所谓的 modern cmake，然后将 KBase 在 POSIX 上的 cmake 文件都按照 modern cmake 的做法做了修改，结果可见<a href="https://github.com/kingsamchen/KBase/commit/da601fe5afaa54b151e64b3ae86faf515b1cae87" target="_blank" rel="noopener">此</a></p>
<p>Modern cmake 有什么好处就不说了，有很多文献可以查，而且我觉得按照目前官方文档的尿性，modern cmake无非是换一种方式踩坑，虽然坑的数量少了不少。</p>
<p>只说几个最核心的点。</p>
<p>首先 modern cmake 推荐按照 module 的方式拆分一个大工程，一个 module 对应一个 CMakeLists.txt，可以是一个 lib，也可以是一个 executable。</p>
<p>每个 module 抽象成一个 target，然后使用新的 <code>target_*</code> 属性去定义这个 target。并且每个 target 之间的属性是可以互相独立的。</p>
<p>工程最顶端是一个 CMakeLists.txt，定义一些全局的属性，然后通过 <code>add_subdirectory()</code> 来关联所有的 module。</p>
<p>几个自己研究过程中看过的一些资料：</p>
<p><a href="https://gist.github.com/mbinna/c61dbb39bca0e4fb7d1f73b0d66a4fd1" target="_blank" rel="noopener">Effective Modern CMake</a></p>
<p><a href="https://github.com/CppCon/CppCon2017/blob/master/Tutorials/Using%20Modern%20CMake%20Patterns%20to%20Enforce%20a%20Good%20Modular%20Design/Using%20Modern%20CMake%20Patterns%20to%20Enforce%20a%20Good%20Modular%20Design%20-%20Mathieu%20Ropert%20-%20CppCon%202017.pdf" target="_blank" rel="noopener">Using Modern CMake Patterns to Enforce a Good Modular Design - Mathieu Ropert - CppCon 2017</a></p>
<p><a href="https://www.slideshare.net/DanielPfeifer1/cmake-48475415" target="_blank" rel="noopener">CMake - Introduction and best practices</a></p>
<p><a href="https://www.slideshare.net/DanielPfeifer1/effective-cmake" target="_blank" rel="noopener">Effective CMake</a></p>
<p>最后，虽然 CMake 看起来已经要成为 C++ 的 de facto build system，但是靠谱的资料却没多少，也缺少像 C++ Core Guideline 这种有影响力的半官方指南。</p>

        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2018/06/10/build-your-own-http-proxy-using-go/">Build Your Own HTTP Proxy Server Using Go</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-06-10
        </span>
        
          <div class="post-category">
            
              <a href="/categories/PROGRAMMING/">PROGRAMMING</a>
            
          </div>
        
        
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <p>Go is a quite awesome programming language for building network applications. So I built my own HTTP proxy server using go last week.</p>
<p>To grasp the essence of how HTTP proxy server works, I choosed to implement it on TCP transport layer, forwarding TCP traffic directly.</p>
<p>Essentially, it runs a server, accepting incoming TCP connections and from which the server extracts target host of a request by parsing HTTP protocol messages. The server then establishes a connection to the target host, and finally operates as an intermedia, forwarding traffic from one host to another.</p>
<p>Implementing a TCP server which is able to handle concurrent requests uing go is easier than you thought: just runs a loop to accept requests, launching a new goroutine for each new connection:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Server <span class="keyword">struct</span> &#123;</span><br><span class="line">	addr     <span class="keyword">string</span></span><br><span class="line">	listener net.Listener</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(srv *Server)</span> <span class="title">Start</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> err error</span><br><span class="line">	srv.listener, err = net.Listen(<span class="string">"tcp"</span>, srv.addr)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatalf(<span class="string">"Failed to listen at %s : %v"</span>, srv.addr, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	log.Printf(<span class="string">"Proxy is listening at %s"</span>, srv.addr)</span><br><span class="line"></span><br><span class="line">	srv.runLoop()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(srv *Server)</span> <span class="title">runLoop</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		conn, err := srv.listener.Accept()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			log.Printf(<span class="string">"Failed to accept an incoming connection : %v"</span>, err)</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">go</span> srv.handleConnection(conn)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(srv *Server)</span> <span class="title">handleConnection</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line">	c := newConnection(conn)</span><br><span class="line">	c.serve()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          <div class="read-more">
            <a href="/2018/06/10/build-your-own-http-proxy-using-go/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2018/06/01/monthly-read-posts-in-may-2018/">Monthly Read Posts in May 2018</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-06-01
        </span>
        
          <div class="post-category">
            
              <a href="/categories/PROGRAMMING/">PROGRAMMING</a>
            
          </div>
        
        
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><p><a href="http://mindhacks.cn/2011/11/04/how-to-interview-a-person-for-two-years/" target="_blank" rel="noopener">怎样花两年时间去面试一个人</a></p>
<p>当前行业招聘的不靠谱，招揽优秀人员的难度大。</p>
<p>脱颖而出的核心：良好的阅读习惯 + Github 项目</p>
<p>这里说的两年是针对应届生来说的，对于已经工作的人来说，可以当作是虚指。</p>
<p>不过文中提到的，拥抱变化的三个核心点：</p>
<ol>
<li>触动内心的大象</li>
<li>建立清晰明确的目标</li>
<li>扫清前进道路的障碍</li>
</ol>
<p>颇有道理。</p>
<hr>
<p><a href="http://gulu-dev.com/post/2014-07-28-tech-evaluation" target="_blank" rel="noopener">何判断一个技术(中间件/库/工具)的靠谱程度？</a></p>
<p>如何做技术选型</p>
<h3 id="System-amp-Architecture"><a href="#System-amp-Architecture" class="headerlink" title="System &amp; Architecture"></a>System &amp; Architecture</h3><p><a href="https://0xffffff.org/2017/05/01/41-linux-io/" target="_blank" rel="noopener">聊聊Linux IO</a></p>
<p>A brief introduction to Linux I/O stack.</p>
<p>这篇 post 的质量在国内技术博客里算是少有的干货。</p>
<p>另，关于 page cache 和 buffer cache 的最新的内容，可以参考 Robert Love 在 quora 上的一个<a href="http://qr.ae/TUTNCz" target="_blank" rel="noopener">回答</a></p>
<hr>
<p><a href="https://www.youtube.com/watch?v=k12BJGSc2Nc" target="_blank" rel="noopener">CppCon 2015: John Farrier “Demystifying Floating Point”</a></p>
<p>工程实践上使用浮点数（IEEE-754）需要注意的一些坑。</p>
<p>看之前最好翻一下 CSAPP 中关于浮点数 IEEE-754 模型的基础知识<br>
          <div class="read-more">
            <a href="/2018/06/01/monthly-read-posts-in-may-2018/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </p></div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2018/05/30/build-your-own-thread-pool-with-cpp/">Build Your Own Threadpool With C++</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-05-30
        </span>
        
          <div class="post-category">
            
              <a href="/categories/PROGRAMMING/">PROGRAMMING</a>
            
          </div>
        
        
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <h2 id="Why-Threadpool-Matters"><a href="#Why-Threadpool-Matters" class="headerlink" title="Why Threadpool Matters"></a>Why Threadpool Matters</h2><p>Why on the earth do we need thread-pool? The answer is obvious: for doing jobs behind the scenes.</p>
<p>That is, saying, you have a constant stream of incoming tasks to complete, and most of which either incur heavy computation or invovle device I/O, you definitely don’t want to execute them on your main thread, because it will block your main thread until the job is done, making your application less responsive.</p>
<p>However, with thread-pool, you can simply submit a task to the pool, then continue what was doing; the task will eventually be completed on a thread of the thread-pool.</p>
<p>If your processor has multiple cores, the task is possibly performed concurrently with your jobs on the main thread.</p>
<h2 id="What-Should-a-Threadpool-Provide"><a href="#What-Should-a-Threadpool-Provide" class="headerlink" title="What Should a Threadpool Provide"></a>What Should a Threadpool Provide</h2><p>Before we switch our focus to editor, we are better to think twice about what we can do with the thread-pool we will build.<br>
          <div class="read-more">
            <a href="/2018/05/30/build-your-own-thread-pool-with-cpp/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </p></div>

    

    

  </article>

    
      
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          <a class="post-link" href="/2018/05/14/demystify-ref-counted-and-weak-ptr-in-chromium-base/">浅析 RefCounted 和 WeakPtr：Chromium Base 篇</a>
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-05-14
        </span>
        
          <div class="post-category">
            
              <a href="/categories/PROGRAMMING/">PROGRAMMING</a>
            
          </div>
        
        
      </div>
    </header>

    
    

    <div class="post-content">
      
        
        
          
        

        
          <p>序言请移步<a href="https://kingsamchen.github.io/2018/03/13/shared-ptr-internals-introduction/">此处</a></p>
<p>MSVC STL 的分析版本请移步<a href="https://kingsamchen.github.io/2018/03/16/demystify-shared-ptr-and-weak-ptr-in-msvc-stl/">此处</a></p>
<p>Libstdc++ 的分析版本请移步<a href="https://kingsamchen.github.io/2018/03/30/demystify-shared-ptr-and-weak-ptr-in-libstdcpp/">此处</a></p>
<p>Boost 的分析版本请移步<a href="https://kingsamchen.github.io/2018/05/02/demystify-shared-ptr-and-weak-ptr-in-boost/">此处</a></p>
<p>注 1：因为这不是第一篇分析，所以会直入主题，跳过文学写作常用的累赘的过渡。</p>
<p>注 2：这是系列最后一篇。</p>
<h2 id="目标版本选择"><a href="#目标版本选择" class="headerlink" title="目标版本选择"></a>目标版本选择</h2><p>Chromium tag 68.0.3421.1</p>
<p>代码位置：<code>base/memory/ref_counted.{h, cc}</code></p>
<h2 id="RefCountedBase-和-RefCounted"><a href="#RefCountedBase-和-RefCounted" class="headerlink" title="RefCountedBase 和 RefCounted"></a>RefCountedBase 和 RefCounted</h2><p>两个类实现了非线程安全的引用计数，即：内部计数使用的是 built-in integer</p>
<p>先看看 <code>RefCountedBase</code> 的大致结构：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RefCountedBase</span> &#123;</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">RefCountedBase</span><span class="params">(StartRefCountFromZeroTag)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">RefCountedBase</span><span class="params">(StartRefCountFromOneTag)</span></span>;</span><br><span class="line"></span><br><span class="line">    ~RefCountedBase();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddRef</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">Release</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">mutable</span> <span class="keyword">uint32_t</span> ref_count_ = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> DCHECK_IS_ON()</span></span><br><span class="line">    <span class="keyword">mutable</span> <span class="keyword">bool</span> needs_adopt_ref_ = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">mutable</span> <span class="keyword">bool</span> in_dtor_ = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">mutable</span> SequenceChecker sequence_checker_;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    DISALLOW_COPY_AND_ASSIGN(RefCountedBase);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>可以看出核心 <code>ref_count_</code> 类型是 <code>uint32_t</code></p>
<p>ctor 和 dtor 都被定义为 protected，说明这类使用做基类；同时提供了 <code>AddRef()</code> 和 <code>Release()</code>，进行内部的计数增减。<br>
          <div class="read-more">
            <a href="/2018/05/14/demystify-ref-counted-and-weak-ptr-in-chromium-base/" class="read-more-link">阅读更多</a>
          </div>
        
      
    </p></div>

    

    

  </article>

    
  </section>

  
  <nav class="pagination">
    
      <a class="prev" href="/page/8/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text">上一页</span>
      </a>
    
    
      <a class="next" href="/page/10/">
        <span class="next-text">下一页</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>


          </div>
          

        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    
    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2019

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Kingsley Chen</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  


    <script type="text/javascript" src="/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.6.0"></script>

  </body>
</html>
